<!doctype html>

<html lang="sl">
<head>
  <meta charset="utf-8">

  <title>Naredi raziskovalni načrt za uporabo v aplikaciji UExperience</title>
  <meta name="description" content="UExperience Research Plan">
  <meta name="author" content="Sara Jakša">

  <script>
        var research_plan = {
                "id": 0,
                "name": "",
                "description":
                    "",
                "organization": "",
                "days": 0,
                "start": "",
                "end": "",
                "privacy": "",
                "researcher": "",
                "email": "",
                "subjectId": null,
                "share": false,
                "beeps": {
                    "aditionalCriteria": false,
                    "importantMomentsOnly": true,
                    "dailyBeeps": 0
                },
                "audio": false,
                "place": false,
                "picture": false,
                "descriptive": false,
                "questions": [
                ]
            }
        var question_id = 1
        function shrani_vprasanja() {
            currentQuestion = {id: question_id, question: document.getElementById("question").value, questionType: document.getElementById("questionType").value, context: document.getElementById("context").checked, possibleAnswers: document.getElementById("possibleAnswers").value};
            research_plan.questions.push(currentQuestion);
            question_id = question_id + 1;
            document.getElementById("question").value = "";
            document.getElementById("possibleAnswers").value = "";

        }
        function save_and_send_research_plan() {
            research_plan.id = new Date().getTime();
            research_plan.name = document.getElementById("name").value;
            research_plan.description = document.getElementById("description").value;
            research_plan.organization = document.getElementById("organization").value;
            research_plan.days = Number(document.getElementById("days").value);
            research_plan.start = document.getElementById("start").value;
            research_plan.end = document.getElementById("end").value;
            research_plan.privacy = document.getElementById("privacy").value;
            research_plan.researcher = document.getElementById("researcher").value;
            research_plan.email = document.getElementById("email").value;
            research_plan.beeps.importantMomentsOnly = document.getElementById("importantMoments").checked && !document.getElementById("place").checked && !document.getElementById("time").checked;
            research_plan.beeps.dailyBeeps = Number(document.getElementById("dailyBeeps").value);
            research_plan.beeps.location = document.getElementById("location").value;
            research_plan.audio = false;
            research_plan.picture = document.getElementById("infoPicture").checked;
            research_plan.descriptive = document.getElementById("description").checked;
            research_plan.place = document.getElementById("infoLocation").checked;
            var request = new XMLHttpRequest();
            request.open('POST', 'https://testing.sarajaksa.eu/uexperience.php', true);
            request.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
            request.send(JSON.stringify(research_plan));
            document.getElementById("name").value = "";
            document.getElementById("description").value = "";
            document.getElementById("organization").value = "";
            document.getElementById("days").value = "";
            document.getElementById("start").value = "";
            document.getElementById("end").value = "";
            document.getElementById("privacy").value = "";
            document.getElementById("researcher").value = "";
            document.getElementById("email").value = "";
            document.getElementById("importantMoments").checked = false;
            document.getElementById("place").checked = false;
            document.getElementById("time").checked = false;
            document.getElementById("dailyBeeps").value = "";
            document.getElementById("location").value = "";
            document.getElementById("infoPicture").checked = false;
            document.getElementById("description").checked = false;
            document.getElementById("infoLocation").checked = false;
            research_plan = {
                "id": 0,
                "name": "",
                "description":
                    "",
                "organization": "",
                "days": 0,
                "start": "",
                "end": "",
                "privacy": "",
                "researcher": "",
                "email": "",
                "subjectId": null,
                "share": false,
                "beeps": {
                    "aditionalCriteria": false,
                    "importantMomentsOnly": true,
                    "dailyBeeps": 0
                },
                "audio": false,
                "place": false,
                "picture": false,
                "descriptive": false,
                "questions": [
                ]
            }

        }
        function typeQuestionCheck(nameSelect)
            {
                if (nameSelect.value === "TagsNoAdd" || nameSelect.value === "MultipleChoice"){
                    document.getElementById("possibleAnswersField").style.display = "block";
                }
                else{
                    document.getElementById("possibleAnswersField").style.display = "none";
                }
            }
        function time_show() {
            if (document.getElementById("time").checked == true){
                beepsDay.style.display = "block";
            } else {
                beepsDay.style.display = "none";
            }
        }
        function location_show() {
            if (document.getElementById("place").checked == true){
                beepsLocation.style.display = "block";
            } else {
                beepsLocation.style.display = "none";
            }

        }
  </script>

</head>

<body>
<form>
<h1>Dodaj raziskovalni načrt za aplikacijo UExperience</h1>
<h2>Osnovne informacije</h2>
<p>Kakšno je ime raziskovalnega projekta? </p>
<input type="text" name="name" id="name">
<p>Kakšen je bolj podroben opis raziskovalnega projekta?</p>
<input type="text" style="height:200px;width:600px;" name="description" id="description">
<p>Katera organizacija je odgovorna za projekt?</p>
<input type="text" name="organization" id="organization">
<p>Koliko dni bo so-raziskovalec vključen v raziskovanje doživljanja? (to se uporablja pri začetnemu ustvarjanju notifikacij za raziskovanje)</p>
<input type="number" name="days" id="days">
<p>Kdaj se je/bo začelo raziskovanje?</p>
<input type="date" name="start" id="start">
<p>Kdaj se bo začelo raziskovanje?</p>
<input type="date" name="end" id="end">
<p>Poleg informacij, ki jih soraziskovalec vnese pri bip-u, kateri podatki se še shranjujejo?</p>
<input type="text" name="privacy" id="privacy">
<p>Kakšno je ime raziskovalca, ki izvaja to raziskavo?</p>
<input type="text" name="researcher" id="researcher">
<p>Kakšna je elektronska pošta raziskovalca, ki izvaja to raziskavo? (na ta elektronski naslov lahko potem soraziskovalci pošljejo svoje bip-e)</p>
<input type="text" name="email" id="email">
<h2>Notifikacije</h2>
<p>Katero vrsto notifikacij vsebuje to raziskovanje?</p>
<input type="checkbox" name="importantMoments" value="true" id="importantMoments"> Pomembni trenutki
<input type="checkbox" name="time" value="true" onClick="time_show();" id="time"> Časovni bip-i
<input type="checkbox" name="place" value="true" onClick="location_show();" id="place"> Lokacija
<div id="beepsDay" style="display:none;">
<p>Koliko bip-ov na dan naj se ustvari?</p>
<input type="number" name="dailyBeeps" id="dailyBeeps">
</div>
<div id="beepsLocation" style="display:none;">
<p>Na kateri lokaciji naj se sprožijo bip-i? (Vstavi zemljepisno dolžino in širino ločeno z vejico. Zemljepisno širino in dolžino lahko dobiš na <a href="https://www.latlong.net/">tukaj</a>)
<input type="text" name="location" id="location">
</div>
<h2>Shranjene informacije</h2>
<p>Katere informacije naj se shranijo pri bip-ih oz. se imajo možnost shraniti pri bip-ih?</p>
<input type="checkbox" name="description" value="true" id="description">Celoten opis doživljanja (poleg predpripravljenih vprašanj)
<input type="checkbox" name="infoLocation" value="true" id="infoLocation">Lokacija
<input type="checkbox" name="infoPicture" value="true" id="infoPicture">Slike (ki jih slika soraziskovalec sam)
<h2>Predpripravljena vprašanja</h2>
<p>Vnesi informacije za predpripravljena vprašanja - če nobeno vprašanje ni vneseno, ta raziskovalni načrt nima vnaprej postavljenih vprašanj. Štela se bodo le vprašanja, ki so bodo shranila preden se raziskovalni načrt pošlje na server.</p> 
<p>Kako se glasi vprašanje?</p>
<input type="text" name="question" id="question">
<p><input type="checkbox" name="context" id="context">Vprašanje je iz konteksta (namesto doživljanja)</p>
<p>Katerega tipa je vprašanje?</p>
<form>
  <select name=questionType id="questionType" onchange="typeQuestionCheck(this);">
    <option value="Binary">Binarno (ja/ne vprašanje)</option>
    <option value="MultipleChoice">Vprašanje z več možnimi odgovori (možno izbrati le en odgovor)</option>
    <option value="TagsNoAdd">Vprašanje z več možnimi odgovori (kjer je možno izbrati več kot en odgovor)</option>
    <option value="Tags">Vprašanje z tagi</option>
    <option value="Slider">Slider (izbira vrednosti med 0 in 100)</option>
    <option value="Text">Prosto besedilo</option>
  </select>
  <div id="possibleAnswersField" style="display:none;">
  <p>Kakšni so možni odgovori (loči različne odgovore z vejico):</p>
  <input type="text" name="possibleAnswers" id="possibleAnswers"><br>
  </div>
  <p><button type="button" onClick="shrani_vprasanja();">Dodaj Vprašanje</button> </p>
</form> 
<button type="button" onClick="save_and_send_research_plan();">Shrani in pošlji raziskovalni načrt</button> 
</form>
</body>
</html>
